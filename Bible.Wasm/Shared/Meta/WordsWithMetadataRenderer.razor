@using Bible.Core.Models.Meta
@using Bible.Core.Extensions
@using Unihan.Models

@if (Text.Words is null || Text.Words.Count == 0)
{
    return;
}

@if (Ruby != null)
{
    <ruby>@Content</ruby>
}
else
{
    @Content
}

@code {
    [Parameter, EditorRequired]
    public WordsWithMetadata Text { get; set; } = default!;

    [Parameter]
    public UnihanField? Ruby { get; set; }

    RenderFragment Content => _builder =>
    {
        foreach (var word in Text.Words)
        {
            _builder.OpenComponent<WordMetadataRenderer>(0);
            _builder.AddAttribute(1, "Word", word);
            _builder.AddAttribute(2, "Ruby", Ruby);
            _builder.CloseComponent();
        }
    };
}